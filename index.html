<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Swift Delivery</title>
    <meta name="description" content="Fast and reliable parcel delivery service" />
    <meta name="author" content="Swift Delivery" />
    
    <!-- Block all search engine indexing and bots -->
    <meta name="robots" content="noindex, nofollow, noarchive, nosnippet, noimageindex" />
    <meta name="googlebot" content="noindex, nofollow" />
    <meta name="bingbot" content="noindex, nofollow" />
    
    <!-- Prevent caching by bots -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />

    <meta property="og:title" content="Swift Delivery" />
    <meta property="og:description" content="Fast and reliable parcel delivery service" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@Lovable" />
    <meta name="twitter:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />
  </head>

  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    
    <!-- Dynamic bot protection - fetches level from admin settings -->
    <script>
      (function() {
        // Skip bot detection for Lovable preview/development environments
        var hostname = window.location.hostname;
        if (hostname.includes('lovable.app') || hostname.includes('localhost') || hostname.includes('127.0.0.1')) {
          return;
        }
        
        // Bot protection checks
        function isAggressiveBot() {
          return (
            navigator.webdriver === true ||
            window.callPhantom !== undefined ||
            window._phantom !== undefined ||
            window.phantom !== undefined ||
            window.__nightmare !== undefined ||
            (navigator.userAgent && /HeadlessChrome|PhantomJS|Selenium|puppeteer|bot|crawl|spider|scrape|headless/i.test(navigator.userAgent))
          );
        }
        
        function isLiteBot() {
          return (
            window.callPhantom !== undefined ||
            window._phantom !== undefined ||
            window.phantom !== undefined ||
            window.__nightmare !== undefined ||
            (navigator.userAgent && /HeadlessChrome|PhantomJS|Selenium|puppeteer/i.test(navigator.userAgent))
          );
        }
        
        function blockAccess() {
          document.body.innerHTML = '<p style="text-align:center;padding:50px;font-family:sans-serif;">Please use a regular browser.</p>';
        }
        
        // Fetch bot protection setting from Supabase
        var supabaseUrl = 'https://mlldxagtunmtcrtlwgfd.supabase.co';
        var supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1sbGR4YWd0dW5tdGNydGx3Z2ZkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg4MzAwMjAsImV4cCI6MjA4NDQwNjAyMH0.hhgFePFcMo-L_1X9eROVLUc7YhTnHEIHfyWQzsBdMUY';
        
        fetch(supabaseUrl + '/rest/v1/admin_settings?setting_key=eq.bot_protection&select=setting_value', {
          headers: {
            'apikey': supabaseKey,
            'Authorization': 'Bearer ' + supabaseKey
          }
        })
        .then(function(res) { return res.json(); })
        .then(function(data) {
          var level = (data && data[0] && data[0].setting_value) || 'off';
          
          if (level === 'aggressive' && isAggressiveBot()) {
            blockAccess();
          } else if (level === 'lite' && isLiteBot()) {
            blockAccess();
          }
          // If 'off', do nothing
        })
        .catch(function() {
          // On error (e.g. RLS block), default to OFF (no protection)
          // This prevents false positives when settings can't be fetched
        });
      })();
    </script>
  </body>
</html>
